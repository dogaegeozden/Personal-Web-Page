<!-- Extending the base html with this html file -->
{% extends "base.html" %}

<!-- Overwriting the metaDescription block -->
{% block metaDescription %}
<meta name=description content="{{ post_detail.text }}">
{% endblock %}

<!-- Overwriting the title block -->
{% block title %}
<title>{{ post_detail.title }} </title>
{% endblock %}

<!-- Overwriting the stylesheet block -->
{% block stylesheet %}
{% load static %}
<link rel='stylesheet' href='{% static "styles/blog/blog_post_detail.css" %}'>
{% endblock %}

<!-- Overwriting the mainBox block -->
{% block mainBox %}
<div id='PostDetailPageBox'>

    <div id="PostDetailContentBox">

        <div class="container">

            <div class="row">
    
                <div class="col-md-8 offset-md-2">
    
                    <!-- Post Title -->
                    <h2 class="text-center">{{ post_detail.title }}</h2>
    
                    <!-- Post Date -->
                    <p class="text-center text-muted">{{ post_detail.date | date:"F d, Y" }}</p>
    
                    <!-- Post Content -->
                    <div class="post-content">
                        
                         <!-- Blog Post Image -->
                         {% if post_detail.image %}
                        
                         <img src="{{ post_detail.image.url }}" class="img-fluid mb-4" alt="{{ post_detail.alt }}">
                         
                         <!-- Blog Post Video -->
                         {% elif post_detail.video %}
                         
                         <video width="100%" height="auto" controls>
     
                             <source src="{{ post_detail.video.url }}" type="video/mp4">
     
                             Your browser does not support the video tag.
     
                         </video>
     
                         {% elif post_detail.youtube_url %}
     
                         <!-- YouTube Video Embed -->
                         <div class="embed-responsive embed-responsive-16by9 mb-4">
     
                             <iframe class="embed-responsive-item" src="{{ post_detail.youtube_url }}" allowfullscreen></iframe>
     
                         </div>
     
                         {% endif %}
    
                        {% if post_detail.para1 %}
                        <p>{{ post_detail.para1 }}</p>
                        {% endif %}
    
                        {% if post_detail.para2 %}
                        <p>{{ post_detail.para2 }}</p>
                        {% endif %}
    
                        {% if post_detail.para3 %}
                        <p>{{ post_detail.para3 }}</p>
                        {% endif %}
    
                        {% if post_detail.para4 %}
                        <p>{{ post_detail.para4 }}</p>
                        {% endif %}
    
                        {% if post_detail.para5 %}
                        <p>{{ post_detail.para5 }}</p>
                        {% endif %}
    
                        {% if post_detail.para6 %}
                        <p>{{ post_detail.para6 }}</p>
                        {% endif %}
    
                        {% if post_detail.para7 %}
                        <p>{{ post_detail.para7 }}</p>
                        {% endif %}
    
                    </div>

                </div>
                
            </div>

            <div class="row">

                <div class="col-md-8 offset-md-2">
                    
                     <!-- <p>Share on social media</p> -->

                     <div class="my-4">

                        <div style="height: 40px; width: 40px; float: left;">

                            <a name="Facebook" class="SocialMediaShareBtn" target="_blank" href="#" onclick="window.open('https://www.facebook.com/sharer/sharer.php?u='+encodeURIComponent(location.href),'facebook-share-dialog','width=626,height=436');return false;">
                                
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-facebook bs-facebook-ico" viewBox="0 0 16 16">
                                
                                    <path d="M16 8.049c0-4.446-3.582-8.05-8-8.05C3.58 0-.002 3.603-.002 8.05c0 4.017 2.926 7.347 6.75 7.951v-5.625h-2.03V8.05H6.75V6.275c0-2.017 1.195-3.131 3.022-3.131.876 0 1.791.157 1.791.157v1.98h-1.009c-.993 0-1.303.621-1.303 1.258v1.51h2.218l-.354 2.326H9.25V16c3.824-.604 6.75-3.934 6.75-7.951"/>
                                
                                </svg>
                            
                            </a>

                        </div>

                        <div style="height: 40px; width: 40px; float: left;">

                            <a name="Twitter" class="SocialMediaShareBtn" target="_blank" href='https://twitter.com/intent/tweet?text=Hey check this out; https://dogaege.pythonanywhere.com/blog/{{ p.title }}'>
                                
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-twitter-x bs-twitter-ico" viewBox="0 0 16 16">
                                    
                                    <path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865l8.875 11.633Z"/>
                                
                                </svg>
                            
                            </a>

                        </div>
                    
                    </div>

                </div>
                
            </div>
                
            <div class="row">

                <div class="col-md-8 offset-md-2">

                    <div class="my-4">
                    
                        {% if post_like_count == 1 %}
    
                        <p>This post has {{ post_like_count }} like</p>
    
                        {% else %}
    
                        <p>This post has {{ post_like_count }} likes</p>
    
                        {% endif %}
    
                        <!-- HTML with Bootstrap classes for the like button -->
                        <button class="btn btn-primary like-button" id="likeButton">

                            {% if post_like_objs.like_status == "l" %}

                            <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" fill="currentColor" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                
                                <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                            
                            </svg>

                            Unlike
                            
                            {% elif post_like_objs.like_status == "n" %}
                            
                            <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16">
                                
                                <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"/>
                            
                            </svg>
                            
                            Like
    
                            {% else %}
    
                            <svg xmlns="http://www.w3.org/2000/svg" width="15" height="15" fill="currentColor" class="bi bi-heart" viewBox="0 0 16 16">
                                
                                <path d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"/>
                            
                            </svg>
                            
                            Like
                            
                            {% endif %}
                        
                        </button>
    
                    </div>

                </div>

            </div>
            
            <div class="row">

                <div class="col-md-8 offset-md-2">
    
                    <!-- Comment Form -->
                    <div class="comment-form">

                        {% if user.is_authenticated %}
                        
                        <h3 class="mb-3">Leave a Comment</h3>
    
                        <form action='{{ post_detail.url }}' method="post">
    
                            {% csrf_token %}
    
                            <div class="form-group">
    
                                <label for="comment">Your Comment:</label>
    
                                <textarea class="form-control" id="id_text" name="text" rows="4" required></textarea>

                            </div>
    
                            <button name="commentbtn" type="submit" class="btn btn-primary mt-3">Submit</button>
    
                        </form>
    
                        {% else %}
                        
                        <h5 class="mb-3">Login to be able to leave a comment</h5>
                        
                        {% endif %}

                    </div>
    
                </div>
                
            </div>

            <div class="row">

                <div class="col-md-8 offset-md-2">
    
                    <div class="comment-section mt-4">
    
                        <div class="card">
                        
                            <div class="card-header bg-primary text-white">
                        
                                <h3 class="card-title">Comments [{{ number_of_comments }}]</h3>
                        
                            </div>

                            <div class="card-body">
                        
                                {% if post_detail.comments.all %}
    
                                <ul class="list-group">
    
                                    {% for comment in post_detail.comments.all %}
    
                                    <li class="list-group-item">
    
                                        <div class="d-flex justify-content-between align-items-center">
    
                                            <span>{{ comment.commenter_name }}</span>
    
                                            <small>{{ comment.comment_time }}</small>
    
                                        </div>
    
                                        <p class="mt-2">{{ comment.text }}</p>
                                        
                                        {% if comment.commenter_name %}
                                        {% if user.username == comment.commenter_name %}

                                        <div style="float: right; cursor: pointer;" onclick="deleteTheComment('{{ comment }}')" class="justify-content-end">

                                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3 DeleteCommentBtn" viewBox="0 0 16 16">
                                             
                                                <path d="M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5M11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5"/>
                                            
                                            </svg>

                                        </div>
                                        {% endif %}
                                        {% endif %}
    
                                    </li>
    
                                    {% endfor %}
    
                                </ul>
                                
                                {% else %}
                                
                                <p>No comments yet.</p>
                                
                                {% endif %}
                            
                            </div>
                        
                        </div>
                    
                    </div>

                </div>
                    
            </div>
    
        </div>

    </div>

</div>
{% endblock %}

<!-- Overwriting the js block -->
{% block js %}
<script>

    sendScreenSize("blog_post_detail_page_visit_information", "{{ csrf_token }}");

</script>

<!-- Creating a script which sends a post request when user clicked to the like button.  -->
<script type="text/javascript">

    // Creating a variable called likeBtn by selecting the element which has LikeBtnFalse class from the DOM.
    let likeBtn = document.querySelector('#likeButton'),

        deleteCommentBtns = document.querySelectorAll('.DeleteCommentBtn');

    // Connecting the likeBtn with the changeLikeStatus function, in a way the function will going to trigger with a click signal.
    likeBtn.addEventListener("click", changeLikeStatus);

    function changeLikeStatus() {
        // A function which changes the likeStatus and sends a post request with the new status

        let likeStatus = "{{ post_like_objs.like_status }}"

        if ( likeStatus == "l") {

            likeStatus = "n"
            
        } else {

            likeStatus = "l"
    
        };

        sendClickInfo("send_like_post_request", likeStatus, "{{ csrf_token }}")
        

        setTimeout(function(){

            // Reloading the current URL.
            location.reload();

        }, 1000)

    }

    function deleteTheComment(e) {

        sendClickInfo("delete_comment_request", e, "{{ csrf_token }}")
        
        setTimeout(function(){

            // Reloading the current URL.
            location.reload();

        }, 1000)

    }

</script>
{% endblock %}
